<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EduCírculos</title>
    <!-- Incluye el CDN de Tailwind CSS para un diseño moderno y responsivo -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: {
                            50: '#eff6ff',
                            100: '#dbeafe',
                            500: '#3b82f6',
                            600: '#2563eb',
                            700: '#1d4ed8',
                            800: '#1e40af',
                            900: '#1e3a8a',
                        }
                    },
                    animation: {
                        'fade-in': 'fadeIn 0.5s ease-in-out',
                        'slide-up': 'slideUp 0.3s ease-out',
                    }
                }
            }
        }
    </script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap');
        
        * {
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
            min-height: 100vh;
        }
        
        /* Glassmorphism effect */
        .glass {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .container-card {
            background: white;
            border-radius: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.08);
            border: 1px solid rgba(229, 231, 235, 0.5);
        }
        
        /* Modern shadows */
        .shadow-modern {
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08), 0 1px 3px rgba(0, 0, 0, 0.05);
        }
        
        .shadow-modern-lg {
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1), 0 4px 8px rgba(0, 0, 0, 0.06);
        }
        
        /* Button styles */
        .btn-primary {
            background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
            border: none;
            border-radius: 12px;
            color: white;
            font-weight: 600;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(59, 130, 246, 0.4);
        }
        
        .btn-secondary {
            background: rgba(255, 255, 255, 0.9);
            border: 1px solid rgba(229, 231, 235, 0.8);
            border-radius: 12px;
            color: #374151;
            font-weight: 500;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }
        
        .btn-secondary:hover {
            background: white;
            border-color: #d1d5db;
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        
        /* Navigation styles */
        .nav-item {
            position: relative;
            padding: 12px 16px;
            border-radius: 12px;
            transition: all 0.3s ease;
            color: #6b7280;
            font-weight: 500;
        }
        
        .nav-item:hover {
            background: rgba(59, 130, 246, 0.08);
            color: #3b82f6;
            transform: translateX(4px);
        }
        
        .nav-item.active {
            background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
            color: white;
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
        }
        
        /* Tutorial styles */
        .tutorial-backdrop {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(8px);
            z-index: 50;
            animation: fadeIn 0.3s ease-out;
        }
        
        .tutorial-modal {
            position: fixed;
            z-index: 60;
            background: white;
            border-radius: 20px;
            padding: 32px;
            max-width: 480px;
            width: 90vw;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.2);
            animation: slideUp 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .tutorial-highlight {
            position: relative;
            z-index: 55;
            outline: 3px solid #3b82f6;
            outline-offset: 4px;
            border-radius: 16px;
            animation: pulse 2s infinite;
        }
        
        /* WhatsApp button */
        .whatsapp-float {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 64px;
            height: 64px;
            background: linear-gradient(135deg, #25d366 0%, #20c25a 100%);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 8px 25px rgba(37, 211, 102, 0.4);
            z-index: 40;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .whatsapp-float:hover {
            transform: scale(1.1) translateY(-4px);
            box-shadow: 0 12px 35px rgba(37, 211, 102, 0.5);
        }
        
        /* Progress bar */
        .progress-container {
            background: #f1f5f9;
            border-radius: 50px;
            height: 8px;
            overflow: hidden;
        }
        
        .progress-bar {
            background: linear-gradient(90deg, #3b82f6 0%, #1d4ed8 100%);
            height: 100%;
            border-radius: 50px;
            transition: width 0.8s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        /* Chat styles */
        .chat-message-user {
            background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
            color: white;
            border-radius: 20px 20px 4px 20px;
            padding: 12px 16px;
            max-width: 70%;
            margin-left: auto;
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
        }
        
        .chat-message-ai {
            background: white;
            color: #374151;
            border-radius: 20px 20px 20px 4px;
            padding: 12px 16px;
            max-width: 70%;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
            border: 1px solid #f3f4f6;
        }
        
        /* Course cards */
        .course-card {
            background: white;
            border-radius: 16px;
            padding: 24px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            border: 1px solid rgba(229, 231, 235, 0.8);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
        }
        
        .course-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.12);
            border-color: rgba(59, 130, 246, 0.2);
        }
        
        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        @keyframes slideUp {
            from { 
                opacity: 0;
                transform: translate(-50%, -30%) scale(0.9);
            }
            to { 
                opacity: 1;
                transform: translate(-50%, -50%) scale(1);
            }
        }
        
        @keyframes pulse {
            0%, 100% { box-shadow: 0 0 0 0 rgba(59, 130, 246, 0.7); }
            50% { box-shadow: 0 0 0 8px rgba(59, 130, 246, 0); }
        }
        
        /* Loading animation */
        .loading-dot {
            width: 8px;
            height: 8px;
            background: #3b82f6;
            border-radius: 50%;
            animation: bounce 1.4s ease-in-out infinite both;
        }
        
        .loading-dot:nth-child(1) { animation-delay: -0.32s; }
        .loading-dot:nth-child(2) { animation-delay: -0.16s; }
        
        @keyframes bounce {
            0%, 80%, 100% { 
                transform: scale(0);
            } 40% { 
                transform: scale(1);
            }
        }
        
        /* Input styles */
        .input-modern {
            background: white;
            border: 2px solid #f3f4f6;
            border-radius: 12px;
            padding: 12px 16px;
            transition: all 0.3s ease;
            font-weight: 500;
        }
        
        .input-modern:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }
        
        /* Statistics cards */
        .stat-card {
            background: white;
            border-radius: 16px;
            padding: 24px;
            text-align: center;
            border: 1px solid rgba(229, 231, 235, 0.8);
            transition: all 0.3s ease;
        }
        
        .stat-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 30px rgba(0, 0, 0, 0.08);
        }
    </style>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
</head>
<body class="min-h-screen">

    <!-- Contenedor Principal -->
    <div id="app" class="w-full max-w-7xl mx-auto">

        <!-- ===== LANDING PAGE ===== -->
        <div id="landing-page" class="w-full min-h-screen p-4">
            <!-- Header -->
            <header class="glass rounded-2xl p-4 mb-8 sticky top-4 z-30">
                <div class="flex flex-col lg:flex-row justify-between items-center">
                    <div class="text-3xl font-bold bg-gradient-to-r from-blue-600 to-blue-800 bg-clip-text text-transparent mb-4 lg:mb-0">
                        EduCírculos
                    </div>
                    <nav class="flex flex-wrap gap-6 items-center">
                        <button onclick="scrollToSection('landing-home')" class="nav-link active">Inicio</button>
                        <button onclick="scrollToSection('about-us')" class="nav-link">Nosotros</button>
                        <button onclick="scrollToSection('courses-section')" class="nav-link">Cursos</button>
                        <button onclick="scrollToSection('testimonials')" class="nav-link">Testimonios</button>
                        <button onclick="scrollToSection('contact-us')" class="nav-link">Contacto</button>
                        <button onclick="showPage('login-page')" class="btn-primary px-6 py-2 rounded-full">
                            Ingresar
                        </button>
                    </nav>
                </div>
            </header>

            <!-- Contenido Principal -->
            <main class="space-y-20">
                <!-- Hero Section -->
                <section id="landing-home" class="container-card p-12 text-center">
                    <div class="max-w-4xl mx-auto">
                        <h1 class="text-6xl font-bold mb-6 bg-gradient-to-r from-blue-600 via-purple-600 to-green-500 bg-clip-text text-transparent leading-tight">
                            Educación de Calidad,<br>
                            <span class="text-green-600">Hecha en Honduras</span>
                        </h1>
                        <p class="text-xl text-gray-600 mb-10 leading-relaxed">
                            Conecta con cursos alineados al currículo nacional, comunidades de aprendizaje y herramientas de IA para impulsar tu futuro.
                        </p>
                        <button onclick="showPage('login-page')" class="btn-primary px-10 py-4 text-lg rounded-2xl">
                            Comienza tu Viaje
                        </button>
                    </div>
                    <div class="mt-16">
                        <div class="w-full h-80 bg-gradient-to-br from-blue-100 to-purple-100 rounded-3xl shadow-modern-lg flex items-center justify-center">
                            <div class="text-center">
                                <div class="text-6xl mb-4">📚</div>
                                <p class="text-xl font-semibold text-gray-700">Aprendizaje Colaborativo</p>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- About Section -->
                <section id="about-us" class="container-card p-12">
                    <div class="grid lg:grid-cols-2 gap-12 items-center">
                        <div>
                            <div class="w-full h-64 bg-gradient-to-br from-green-100 to-blue-100 rounded-3xl shadow-modern flex items-center justify-center">
                                <div class="text-center">
                                    <div class="text-6xl mb-4">🌟</div>
                                    <p class="text-xl font-semibold text-gray-700">Comunidad Educativa</p>
                                </div>
                            </div>
                        </div>
                        <div class="space-y-6">
                            <h2 class="text-4xl font-bold text-gray-800">Quiénes Somos</h2>
                            <p class="text-gray-600 leading-relaxed">
                                EduCírculos es una iniciativa nacida en Honduras con el propósito de democratizar la educación de alta calidad. Creemos firmemente que el acceso al conocimiento es la llave para el progreso personal y comunitario.
                            </p>
                            <p class="text-gray-600 leading-relaxed">
                                Nuestra plataforma ofrece una variedad de cursos alineados con el currículo educativo nacional y complementarios, creados tanto por nuestro equipo de expertos como por una vibrante comunidad de educadores y profesionales.
                            </p>
                        </div>
                    </div>
                </section>

                <!-- Courses Section -->
                <section id="courses-section" class="container-card p-12">
                    <h2 class="text-4xl font-bold text-center text-gray-800 mb-12">Cursos que Transforman</h2>
                    <div class="grid md:grid-cols-3 gap-8">
                        <div class="course-card">
                            <div class="w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center mb-4">
                                <span class="material-icons text-blue-600">code</span>
                            </div>
                            <h3 class="font-bold text-xl mb-3 text-blue-600">Introducción a la Programación</h3>
                            <p class="text-gray-600">Aprende los fundamentos de la lógica de programación con ejercicios prácticos.</p>
                        </div>
                        <div class="course-card">
                            <div class="w-12 h-12 bg-green-100 rounded-xl flex items-center justify-center mb-4">
                                <span class="material-icons text-green-600">history_edu</span>
                            </div>
                            <h3 class="font-bold text-xl mb-3 text-green-600">Historia de Honduras</h3>
                            <p class="text-gray-600">Un viaje fascinante a través del pasado de nuestra querida nación.</p>
                        </div>
                        <div class="course-card">
                            <div class="w-12 h-12 bg-purple-100 rounded-xl flex items-center justify-center mb-4">
                                <span class="material-icons text-purple-600">calculate</span>
                            </div>
                            <h3 class="font-bold text-xl mb-3 text-purple-600">Cálculo Diferencial</h3>
                            <p class="text-gray-600">Curso avanzado diseñado para estudiantes de bachillerato.</p>
                        </div>
                    </div>
                </section>

                <!-- Testimonials -->
                <section id="testimonials" class="container-card p-12">
                    <h2 class="text-4xl font-bold text-center text-gray-800 mb-12">Lo que Dicen Nuestros Usuarios</h2>
                    <div class="grid md:grid-cols-2 gap-8">
                        <div class="bg-gradient-to-br from-blue-50 to-blue-100 p-8 rounded-2xl relative">
                            <div class="text-6xl text-blue-200 absolute -top-4 -left-4 opacity-50">"</div>
                            <p class="text-blue-800 italic mb-6 relative z-10">
                                "Gracias a EduCírculos, pude repasar para mis exámenes de bachillerato y obtuve la mejor nota de mi clase. ¡Los cursos son muy claros y útiles!"
                            </p>
                            <div class="flex items-center">
                                <div class="w-12 h-12 bg-blue-200 rounded-full flex items-center justify-center font-bold text-blue-800 mr-3">
                                    E
                                </div>
                                <div>
                                    <p class="font-semibold text-blue-800">Estudiante</p>
                                    <p class="text-blue-600 text-sm">Bachillerato</p>
                                </div>
                            </div>
                        </div>
                        <div class="bg-gradient-to-br from-green-50 to-green-100 p-8 rounded-2xl relative">
                            <div class="text-6xl text-green-200 absolute -top-4 -left-4 opacity-50">"</div>
                            <p class="text-green-800 italic mb-6 relative z-10">
                                "Como educadora, he encontrado una comunidad de apoyo y las herramientas para crear contenido relevante para mis estudiantes. ¡EduCírculos es fantástico!"
                            </p>
                            <div class="flex items-center">
                                <div class="w-12 h-12 bg-green-200 rounded-full flex items-center justify-center font-bold text-green-800 mr-3">
                                    P
                                </div>
                                <div>
                                    <p class="font-semibold text-green-800">Profesora</p>
                                    <p class="text-green-600 text-sm">Ciencias Sociales</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Contact -->
                <section id="contact-us" class="container-card p-12 mb-10">
                    <h2 class="text-4xl font-bold text-center text-gray-800 mb-8">Contactanos</h2>
                    <p class="text-center text-gray-600 mb-10 max-w-2xl mx-auto">
                        Si tienes alguna pregunta, sugerencia o necesitas ayuda, no dudes en contactarnos. ¡Estamos aquí para servirte!
                    </p>
                    <form class="space-y-6 max-w-xl mx-auto">
                        <div>
                            <label class="block text-gray-700 font-semibold mb-2">Nombre Completo</label>
                            <input type="text" class="input-modern w-full">
                        </div>
                        <div>
                            <label class="block text-gray-700 font-semibold mb-2">Correo Electrónico</label>
                            <input type="email" class="input-modern w-full">
                        </div>
                        <div>
                            <label class="block text-gray-700 font-semibold mb-2">Mensaje</label>
                            <textarea rows="4" class="input-modern w-full resize-none"></textarea>
                        </div>
                        <button type="submit" class="btn-primary w-full py-3 rounded-xl">
                            Enviar Mensaje
                        </button>
                    </form>
                </section>
            </main>
        </div>

        <!-- ===== LOGIN PAGE ===== -->
        <div id="login-page" class="hidden w-full min-h-screen flex items-center justify-center p-4">
            <div class="container-card p-12 text-center max-w-md w-full">
                <h2 class="text-3xl font-bold text-gray-800 mb-6">Iniciar Sesión</h2>
                <p class="text-gray-600 mb-8">Elige tu rol para comenzar tu viaje de aprendizaje.</p>
                <div class="space-y-4">
                    <button onclick="login('student')" class="w-full bg-gradient-to-r from-indigo-500 to-indigo-600 text-white py-4 rounded-xl font-semibold hover:from-indigo-600 hover:to-indigo-700 transition-all duration-300 transform hover:scale-105">
                        Soy un Estudiante
                    </button>
                    <button onclick="login('educator')" class="w-full bg-gradient-to-r from-green-500 to-green-600 text-white py-4 rounded-xl font-semibold hover:from-green-600 hover:to-green-700 transition-all duration-300 transform hover:scale-105">
                        Soy un Educador
                    </button>
                </div>
                <button onclick="showPage('landing-page')" class="mt-8 text-blue-600 hover:text-blue-700 font-semibold">
                    Regresar
                </button>
            </div>
        </div>

        <!-- ===== DASHBOARD ===== -->
        <div id="dashboard" class="hidden w-full min-h-screen p-4 lg:flex gap-6">
            <!-- Sidebar -->
            <aside id="dashboard-sidebar" class="w-full lg:w-80 container-card p-6 h-fit">
                <div class="text-2xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent mb-8">
                    EduCírculos
                </div>
                <ul id="dashboard-nav" class="space-y-2 mb-8">
                    <!-- Navigation items will be rendered here -->
                </ul>
                <div id="user-profile-widget">
                    <!-- User profile widget will be rendered here -->
                </div>
            </aside>
            
            <!-- Main Content -->
            <main id="dashboard-main-content" class="flex-1 container-card p-8 overflow-y-auto max-h-screen">
                <div id="dashboard-content">
                    <!-- Dashboard content will be rendered here -->
                </div>
            </main>
        </div>

        <!-- WhatsApp Button -->
        <a href="https://wa.me/50433333333" target="_blank" class="whatsapp-float">
            <svg class="w-8 h-8" fill="currentColor" viewBox="0 0 16 16">
                <path d="M13.601 2.326A7.854 7.854 0 0 0 7.994 0C3.627 0 .068 3.558.064 7.928c0 1.399.366 2.76 1.057 3.965L.16 15.838l4.06-1.057a7.93 7.93 0 0 0 3.777.96h.004c4.368 0 7.926-3.558 7.93-7.93A7.898 7.898 0 0 0 13.6 2.326zM7.994 14.521a6.573 6.573 0 0 1-3.356-.92l-.24-.144-2.494.654.666-2.433-.156-.251a6.56 6.56 0 0 1-1.007-3.505c0-3.626 2.957-6.584 6.591-6.584a6.56 6.56 0 0 1 4.66 1.931 6.557 6.557 0 0 1 1.928 4.66c-.004 3.639-2.961 6.592-6.592 6.592zm3.615-4.934c-.197-.099-1.17-.578-1.353-.646-.182-.068-.315-.099-.445.099-.133.197-.513.646-.627.775-.114.133-.232.148-.43.05-.197-.1-.836-.308-1.592-.985-.59-.525-.985-1.175-1.103-1.372-.114-.198-.011-.304.088-.403.087-.088.197-.232.296-.346.1-.114.133-.198.198-.33.065-.134.034-.248-.015-.347-.05-.1-.445-1.076-.612-1.47-.16-.389-.323-.335-.445-.34-.114-.007-.247-.007-.38-.007a.729.729 0 0 0-.529.247c-.182.198-.691.677-.691 1.654 0 .977.71 1.916.81 2.049.098.133 1.394 2.132 3.383 2.992.47.205.84.326 1.129.418.475.152.904.129 1.246.08.38-.058 1.171-.48 1.338-.943.164-.464.164-.86.114-.943-.049-.084-.182-.133-.38-.232z"/>
            </svg>
        </a>
    </div>
    
    <!-- Tutorial Modal -->
    <div id="welcome-tutorial" class="hidden">
        <div class="tutorial-backdrop" onclick="endTutorial()"></div>
        <div id="tutorial-modal" class="tutorial-modal">
            <!-- Tutorial content will be rendered here -->
        </div>
    </div>

    <script>
        'use strict';
        
        // Global variables
        let currentTutorialStep = 0;
        let userRole = '';
        
        // Tutorial steps
        const tutorialSteps = [
            {
                title: '¡Bienvenido a EduCírculos!',
                content: 'Estamos muy contentos de tenerte aquí. Este breve tutorial te mostrará las funciones principales de la plataforma para que comiences tu viaje de aprendizaje.',
                highlightElement: null
            },
            {
                title: 'Tu Centro de Navegación',
                content: 'Este es el menú principal. Desde aquí puedes acceder a tus cursos, unirte a círculos de estudio, revisar tu perfil y mucho más.',
                highlightElement: '#dashboard-sidebar'
            },
            {
                title: 'Área Principal',
                content: 'Aquí es donde ocurre la magia. El contenido de cada sección, como tus cursos o los debates de los círculos, aparecerá en esta área principal.',
                highlightElement: '#dashboard-main-content'
            },
            {
                title: 'Asistente Inteligente',
                content: '¿Tienes alguna pregunta? Nuestro asistente de IA está aquí para ayudarte. Pídele ayuda con tus tareas, explicaciones de temas o ideas para nuevos cursos.',
                highlightElement: '[data-nav="chat"]'
            },
            {
                title: '¡Listo para Empezar!',
                content: 'Has completado el recorrido. Explora la plataforma, inscríbete en un curso y comienza a aprender. ¡El conocimiento te espera!',
                highlightElement: null
            }
        ];

        // Tutorial functions
        function startTutorial() {
            currentTutorialStep = 0;
            document.getElementById('welcome-tutorial').classList.remove('hidden');
            renderTutorialStep();
        }
        
        function renderTutorialStep() {
            // Clear previous highlights
            document.querySelectorAll('.tutorial-highlight').forEach(el => {
                el.classList.remove('tutorial-highlight');
            });
            
            const step = tutorialSteps[currentTutorialStep];
            if (!step) {
                endTutorial();
                return;
            }

            const modal = document.getElementById('tutorial-modal');
            
            // Update modal content
            const prevButtonDisabled = currentTutorialStep === 0 ? 'opacity-50 cursor-not-allowed' : 'hover:text-gray-800';
            const nextButtonText = (currentTutorialStep === tutorialSteps.length - 1) ? 'Finalizar' : 'Siguiente';
            
            modal.innerHTML = `
                <div class="text-center">
                    <h3 class="text-2xl font-bold text-gray-800 mb-4">${step.title}</h3>
                    <p class="text-gray-600 mb-8 leading-relaxed">${step.content}</p>
                    <div class="flex justify-between items-center">
                        <button onclick="prevTutorialStep()" class="text-gray-500 font-semibold ${prevButtonDisabled} transition-colors" ${currentTutorialStep === 0 ? 'disabled' : ''}>
                            Anterior
                        </button>
                        <div class="flex gap-2">
                            ${tutorialSteps.map((_, index) => `
                                <div class="w-3 h-3 rounded-full transition-colors ${index === currentTutorialStep ? 'bg-blue-600' : 'bg-gray-300'}"></div>
                            `).join('')}
                        </div>
                        <button onclick="nextTutorialStep()" class="btn-primary px-6 py-2 rounded-xl">
                            ${nextButtonText}
                        </button>
                    </div>
                </div>
            `;

            // Position modal and highlight element
            setTimeout(() => {
                const targetElement = step.highlightElement ? document.querySelector(step.highlightElement) : null;

                if (targetElement) {
                    // Ensure element is visible first
                    targetElement.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    
                    // Wait for scroll animation to complete
                    setTimeout(() => {
                        targetElement.classList.add('tutorial-highlight');
                        positionModal(targetElement, modal);
                    }, 500);
                } else {
                    // Center modal if no element to highlight
                    modal.style.top = '50%';
                    modal.style.left = '50%';
                    modal.style.transform = 'translate(-50%, -50%)';
                }
            }, 100);
        }

        function positionModal(targetElement, modal) {
            const rect = targetElement.getBoundingClientRect();
            const modalWidth = 480; // Max width from CSS
            const modalHeight = 250; // Approximate height
            
            // Calculate position
            let top = rect.bottom + 20;
            let left = rect.left + (rect.width / 2);
            
            // Ensure modal stays within viewport
            if (top + modalHeight > window.innerHeight) {
                top = rect.top - modalHeight - 20;
            }
            
            // Ensure modal doesn't go off screen horizontally
            const halfModalWidth = Math.min(modalWidth, window.innerWidth * 0.9) / 2;
            left = Math.max(halfModalWidth + 20, Math.min(left, window.innerWidth - halfModalWidth - 20));
            
            // Apply positioning
            modal.style.top = `${Math.max(20, top)}px`;
            modal.style.left = `${left}px`;
            modal.style.transform = 'translateX(-50%)';
        }

        function nextTutorialStep() {
            currentTutorialStep++;
            renderTutorialStep();
        }
        
        function prevTutorialStep() {
            if (currentTutorialStep > 0) {
                currentTutorialStep--;
                renderTutorialStep();
            }
        }

        function endTutorial() {
            document.getElementById('welcome-tutorial').classList.add('hidden');
            document.querySelectorAll('.tutorial-highlight').forEach(el => {
                el.classList.remove('tutorial-highlight');
            });
        }

        // Page navigation functions
        function showPage(pageId) {
            const pages = ['landing-page', 'login-page', 'dashboard'];
            pages.forEach(id => {
                const page = document.getElementById(id);
                if (id === pageId) {
                    page.classList.remove('hidden');
                    if (id === 'dashboard') {
                        page.classList.add('lg:flex');
                    } else {
                        page.classList.add('block');
                    }
                } else {
                    page.classList.add('hidden');
                    page.classList.remove('block', 'lg:flex');
                }
            });
        }

        function scrollToSection(sectionId) {
            // Update active navigation
            document.querySelectorAll('.nav-link').forEach(btn => btn.classList.remove('active'));
            document.querySelector(`button[onclick="scrollToSection('${sectionId}')"]`)?.classList.add('active');
            
            // Scroll to section
            const section = document.getElementById(sectionId);
            if (section) {
                section.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
        }

        function login(role) {
            userRole = role;
            renderDashboardNav();
            showPage('dashboard');
            showDashboardContent('home');
            
            // Start tutorial after a short delay to ensure dashboard is rendered
            setTimeout(startTutorial, 300);
        }

        // Dashboard navigation rendering
        function renderDashboardNav() {
            const nav = document.getElementById('dashboard-nav');
            if (!nav) return;

            let navItems = [
                { id: 'home', icon: 'home', label: 'Inicio' },
                { id: 'courses', icon: 'school', label: 'Cursos' },
                { id: 'circles', icon: 'groups', label: 'Círculos' },
                { id: 'credits', icon: 'monetization_on', label: 'EduCréditos' },
                { id: 'chat', icon: 'chat', label: 'Chat con IA' },
                { id: 'notifications', icon: 'notifications', label: 'Notificaciones' },
                { id: 'plans', icon: 'workspace_premium', label: 'Cambiar Plan' }
            ];

            if (userRole === 'educator') {
                navItems.push(
                    { divider: true },
                    { header: 'Educador' },
                    { id: 'educator-dashboard', icon: 'dashboard', label: 'Panel de Control' },
                    { id: 'course-management', icon: 'edit_note', label: 'Gestión de Cursos' },
                    { id: 'circle-creation', icon: 'add_circle', label: 'Crear Círculo' },
                    { id: 'student-management', icon: 'group', label: 'Estudiantes' },
                    { id: 'analytics', icon: 'analytics', label: 'Analíticas' },
                    { id: 'certificates', icon: 'workspace_premium', label: 'Certificados' },
                    { id: 'payments', icon: 'payments', label: 'Ingresos' },
                    { id: 'profile', icon: 'person', label: 'Mi Perfil' }
                );
            } else if (userRole === 'student') {
                navItems.push(
                    { divider: true },
                    { id: 'student-profile', icon: 'person', label: 'Mi Perfil' },
                    { id: 'student-progress', icon: 'trending_up', label: 'Progreso' }
                );
            }

            navItems.push(
                { divider: true },
                { id: 'logout', icon: 'logout', label: 'Cerrar Sesión', isAction: true, actionName: 'showPage', actionParam: "'landing-page'" }
            );

            let navHTML = '';
            navItems.forEach(item => {
                if (item.divider) {
                    navHTML += '<li class="py-2"><hr class="border-gray-200"></li>';
                } else if (item.header) {
                    navHTML += `<li class="mt-2 mb-1"><span class="text-xs font-bold text-gray-400 uppercase px-4">${item.header}</span></li>`;
                } else {
                    const action = item.isAction ? `${item.actionName}(${item.actionParam})` : `showDashboardContent('${item.id}')`;
                    navHTML += `
                        <li>
                            <button onclick="${action}"
                                    data-nav="${item.id}"
                                    class="nav-item w-full flex items-center gap-3 ${item.id === 'logout' ? 'text-red-500 hover:bg-red-50' : ''}">
                                <span class="material-icons">${item.icon}</span>
                                <span class="font-medium">${item.label}</span>
                            </button>
                        </li>`;
                }
            });

            nav.innerHTML = navHTML;
            renderUserProfileWidget();
        }
        
        function renderUserProfileWidget() {
            const widget = document.getElementById('user-profile-widget');
            if (!widget) return;

            const userName = userRole === 'student' ? 'Juan Pérez' : 'Ana Meléndez';
            const userInitials = userRole === 'student' ? 'JP' : 'AM';

            widget.innerHTML = `
                <div class="border-t border-gray-200 pt-4">
                    <div class="flex items-center gap-3">
                        <div class="w-12 h-12 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center font-bold text-white shadow-md">
                            ${userInitials}
                        </div>
                        <div>
                            <p class="font-semibold text-gray-800">${userName}</p>
                            <p class="text-sm text-gray-500 capitalize">${userRole}</p>
                        </div>
                    </div>
                </div>
            `;
        }
        
        // --- Dashboard Content Rendering ---
        function showDashboardContent(contentId, param = '') {
            // Update active nav item
            document.querySelectorAll('.nav-item').forEach(item => item.classList.remove('active'));
            document.querySelector(`[data-nav="${contentId}"]`)?.classList.add('active');

            const contentArea = document.getElementById('dashboard-content');
            let content = '';
            
            // --- Mapa de funciones para renderizar contenido ---
            const renderMap = {
                'home': renderHomeContent,
                'courses': renderCoursesContent,
                'circles': renderCirclesContent,
                'credits': renderCreditsContent,
                'chat': renderChatContent,
                'notifications': renderNotificationsContent,
                'plans': renderPlansContent,
                'student-profile': renderStudentProfileContent,
                'student-progress': renderStudentProgressContent,
                'educator-dashboard': renderHomeContent, // Alias for educator home
                'profile': renderEducatorProfileContent,
                'course-management': renderCourseManagementContent,
                'circle-creation': renderCircleCreationContent,
                'student-management': renderStudentManagementContent,
                'analytics': renderAnalyticsContent,
                'certificates': renderEducatorCertificatesContent,
                'payments': renderPaymentsContent,
                'view-course': () => renderViewCourseContent(param),
                'view-circle': () => renderViewCircleContent(param)
            };
            
            if (renderMap[contentId]) {
                content = renderMap[contentId]();
            } else {
                 content = `
                    <div class="text-center py-20 animate-fade-in">
                        <div class="text-6xl mb-4">🚧</div>
                        <h3 class="text-2xl font-semibold text-gray-800 mb-2">Sección en Desarrollo</h3>
                        <p class="text-gray-600">La funcionalidad para <strong>${contentId}</strong> estará disponible próximamente.</p>
                    </div>`;
            }

            contentArea.innerHTML = content;
            
            // Initialize functionality for specific views
            if (contentId === 'chat') {
                initializeChat();
            } else if (contentId === 'view-circle') {
                initializeCircleChat();
            }
        }

        // --- Content Render Functions ---

        function renderHomeContent() {
            if (userRole === 'student') {
                return renderStudentHomeContent();
            } else {
                return renderEducatorDashboardContent();
            }
        }

        function renderStudentHomeContent() {
            return `
                <div class="space-y-8 animate-fade-in">
                    <div>
                        <h2 class="text-3xl font-bold text-gray-800 mb-2">¡Hola, bienvenido de vuelta!</h2>
                        <p class="text-gray-600">Continúa tu viaje de aprendizaje donde lo dejaste</p>
                    </div>
                    
                    <div>
                        <h3 class="text-2xl font-semibold text-gray-700 mb-6">Continuar Aprendiendo</h3>
                        <div class="grid md:grid-cols-2 gap-6">
                             <div class="course-card">
                                <div class="flex items-center gap-3 mb-4">
                                    <div class="w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center">
                                        <span class="material-icons text-blue-600">code</span>
                                    </div>
                                    <div>
                                        <h4 class="font-bold text-lg text-blue-600">Introducción a la Programación</h4>
                                        <p class="text-sm text-gray-600">Continúa donde lo dejaste</p>
                                    </div>
                                </div>
                                <div class="progress-container mb-4">
                                    <div class="progress-bar" style="width: 75%;"></div>
                                </div>
                                <div class="flex justify-between items-center">
                                    <span class="text-sm font-semibold text-gray-500">75% Completado</span>
                                    <button onclick="showDashboardContent('view-course', 'programacion')" class="btn-primary px-4 py-2 rounded-lg text-sm">Continuar</button>
                                </div>
                            </div>
                            
                            <div class="course-card">
                                <div class="flex items-center gap-3 mb-4">
                                    <div class="w-12 h-12 bg-green-100 rounded-xl flex items-center justify-center">
                                        <span class="material-icons text-green-600">history_edu</span>
                                    </div>
                                    <div>
                                        <h4 class="font-bold text-lg text-green-600">Historia de Honduras</h4>
                                        <p class="text-sm text-gray-600">Próximo capítulo disponible</p>
                                    </div>
                                </div>
                                <div class="progress-container mb-4">
                                    <div class="progress-bar" style="width: 20%;"></div>
                                </div>
                                <div class="flex justify-between items-center">
                                    <span class="text-sm font-semibold text-gray-500">20% Completado</span>
                                    <button onclick="showDashboardContent('view-course', 'historia')" class="btn-primary px-4 py-2 rounded-lg text-sm">Continuar</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }
        
        function renderEducatorDashboardContent() {
             return `
                <div class="space-y-8 animate-fade-in">
                    <div>
                        <h2 class="text-3xl font-bold text-gray-800 mb-2">Panel de Control del Educador</h2>
                        <p class="text-gray-600">Gestiona tus cursos y estudiantes desde aquí</p>
                    </div>
                    
                    <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-6">
                        <div class="stat-card bg-gradient-to-br from-blue-50 to-blue-100">
                            <div class="text-3xl font-bold text-blue-600 mb-1">5</div>
                            <div class="text-blue-600 font-semibold">Cursos Creados</div>
                        </div>
                        <div class="stat-card bg-gradient-to-br from-green-50 to-green-100">
                            <div class="text-3xl font-bold text-green-600 mb-1">120</div>
                            <div class="text-green-600 font-semibold">Estudiantes</div>
                        </div>
                        <div class="stat-card bg-gradient-to-br from-purple-50 to-purple-100">
                            <div class="text-3xl font-bold text-purple-600 mb-1">4.8 ★</div>
                            <div class="text-purple-600 font-semibold">Calificación</div>
                        </div>
                        <div class="stat-card bg-gradient-to-br from-yellow-50 to-yellow-100">
                            <div class="text-3xl font-bold text-yellow-600 mb-1">L. 3,200</div>
                            <div class="text-yellow-600 font-semibold">Ingresos</div>
                        </div>
                    </div>
                    
                    <div class="container-card p-8">
                        <h3 class="text-2xl font-semibold text-gray-800 mb-6">Acceso Rápido</h3>
                        <div class="grid md:grid-cols-2 gap-6">
                            <button onclick="showDashboardContent('course-management')" 
                                    class="btn-primary p-6 rounded-2xl flex items-center justify-center gap-3 text-lg">
                                <span class="material-icons text-2xl">add_circle</span>
                                Crear Nuevo Curso
                            </button>
                            <button onclick="showDashboardContent('circle-creation')" 
                                    class="bg-gradient-to-r from-green-500 to-green-600 text-white p-6 rounded-2xl hover:from-green-600 hover:to-green-700 transition-all duration-300 flex items-center justify-center gap-3 text-lg font-semibold">
                                <span class="material-icons text-2xl">groups</span>
                                Crear Círculo
                            </button>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderChatContent() {
            return `
                <div class="h-full flex flex-col animate-fade-in">
                    <div class="mb-6">
                        <h2 class="text-3xl font-bold text-gray-800 mb-2">Asistente de IA</h2>
                        <p class="text-gray-600">Pregunta lo que necesites sobre tus estudios</p>
                    </div>
                    
                    <div class="flex-1 bg-gray-50 rounded-2xl p-6 flex flex-col">
                        <div id="chat-messages" class="flex-1 overflow-y-auto space-y-4 mb-6 pr-2">
                            <div class="flex justify-start">
                                <div class="chat-message-ai">
                                    ¡Hola! Soy tu asistente de IA de EduCírculos. ¿Cómo puedo ayudarte a aprender hoy?
                                </div>
                            </div>
                        </div>
                        
                        <div id="loading-indicator" class="hidden flex justify-start mb-4">
                            <div class="bg-white rounded-2xl p-4 flex gap-2">
                                <div class="loading-dot"></div>
                                <div class="loading-dot"></div>
                                <div class="loading-dot"></div>
                            </div>
                        </div>
                        
                        <div class="flex gap-3">
                            <input type="text" id="chat-input" 
                                   placeholder="Escribe tu pregunta aquí..." 
                                   class="flex-1 input-modern">
                            <button id="send-button" class="btn-primary px-6 py-3 rounded-xl flex items-center gap-2">
                                <span class="material-icons">send</span>
                            </button>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderCoursesContent() {
             return `
                <div class="space-y-8 animate-fade-in">
                    <div>
                        <h2 class="text-3xl font-bold text-gray-800 mb-2">Explorar Cursos</h2>
                        <p class="text-gray-600">Descubre cursos que impulsen tu crecimiento académico</p>
                    </div>
                    
                    <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
                        <div class="course-card group">
                             <div class="w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center mb-4">
                                <span class="material-icons text-blue-600">code</span>
                            </div>
                            <h3 class="font-bold text-xl text-blue-600 mb-3">Introducción a la Programación</h3>
                            <p class="text-gray-600 mb-4">Aprende los fundamentos de la programación con ejercicios prácticos y proyectos reales.</p>
                            <div class="flex items-center justify-between mb-4">
                                <span class="text-sm text-gray-500">12 lecciones</span>
                                <div class="flex items-center gap-1">
                                    <span class="material-icons text-yellow-400 text-sm">star</span>
                                    <span class="text-sm font-semibold">4.9</span>
                                </div>
                            </div>
                            <button onclick="showDashboardContent('view-course', 'programacion')" class="btn-primary w-full py-2 rounded-lg">Inscribirse</button>
                        </div>
                        
                        <div class="course-card">
                             <div class="w-12 h-12 bg-green-100 rounded-xl flex items-center justify-center mb-4">
                                <span class="material-icons text-green-600">history_edu</span>
                            </div>
                            <h3 class="font-bold text-xl text-green-600 mb-3">Historia de Honduras</h3>
                            <p class="text-gray-600 mb-4">Un viaje fascinante a través del pasado de nuestra querida nación.</p>
                             <div class="flex items-center justify-between mb-4">
                                <span class="text-sm text-gray-500">15 lecciones</span>
                                <div class="flex items-center gap-1">
                                    <span class="material-icons text-yellow-400 text-sm">star</span>
                                    <span class="text-sm font-semibold">4.8</span>
                                </div>
                            </div>
                            <button onclick="showDashboardContent('view-course', 'historia')" class="btn-primary w-full py-2 rounded-lg">Inscribirse</button>
                        </div>
                        
                        <div class="course-card">
                             <div class="w-12 h-12 bg-purple-100 rounded-xl flex items-center justify-center mb-4">
                                <span class="material-icons text-purple-600">calculate</span>
                            </div>
                            <h3 class="font-bold text-xl text-purple-600 mb-3">Cálculo Diferencial</h3>
                            <p class="text-gray-600 mb-4">Curso avanzado diseñado específicamente para estudiantes de bachillerato.</p>
                             <div class="flex items-center justify-between mb-4">
                                <span class="text-sm text-gray-500">20 lecciones</span>
                                <div class="flex items-center gap-1">
                                    <span class="material-icons text-yellow-400 text-sm">star</span>
                                    <span class="text-sm font-semibold">4.7</span>
                                </div>
                            </div>
                            <button class="btn-secondary w-full py-2 rounded-lg flex items-center justify-center gap-2">
                                <span class="material-icons text-yellow-500 text-base">monetization_on</span>
                                Desbloquear con 50 EduCréditos
                            </button>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderCirclesContent() {
            return `
                <div class="space-y-8 animate-fade-in">
                    <div>
                        <h2 class="text-3xl font-bold text-gray-800 mb-2">Círculos de Estudio</h2>
                        <p class="text-gray-600">Únete a comunidades de aprendizaje colaborativo</p>
                    </div>
                    
                    <div class="grid md:grid-cols-2 gap-6">
                        <div class="container-card p-6">
                            <div class="flex items-center gap-4 mb-4">
                                <div class="w-16 h-16 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center">
                                    <span class="material-icons text-white text-2xl">groups</span>
                                </div>
                                <div>
                                    <h3 class="font-bold text-xl text-gray-800">Círculo de Matemáticas</h3>
                                    <p class="text-gray-600">24 miembros activos</p>
                                </div>
                            </div>
                            <p class="text-gray-600 mb-4">Resuelve problemas matemáticos complejos junto a otros estudiantes y mentores experimentados.</p>
                            <button onclick="showDashboardContent('view-circle', 'Matemáticas')" class="btn-primary w-full py-3 rounded-xl">Unirse al Círculo</button>
                        </div>
                        
                        <div class="container-card p-6">
                            <div class="flex items-center gap-4 mb-4">
                                <div class="w-16 h-16 bg-gradient-to-br from-green-500 to-teal-600 rounded-full flex items-center justify-center">
                                    <span class="material-icons text-white text-2xl">science</span>
                                </div>
                                <div>
                                    <h3 class="font-bold text-xl text-gray-800">Laboratorio de Química</h3>
                                    <p class="text-gray-600">18 miembros activos</p>
                                </div>
                            </div>
                            <p class="text-gray-600 mb-4">Experimenta y aprende química de manera práctica con compañeros que comparten tu pasión por la ciencia.</p>
                            <button onclick="showDashboardContent('view-circle', 'Química')" class="btn-primary w-full py-3 rounded-xl">Unirse al Círculo</button>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderCreditsContent() {
            return `
                <div class="space-y-8 animate-fade-in">
                    <div>
                        <h2 class="text-3xl font-bold text-gray-800 mb-2">Mis EduCréditos</h2>
                        <p class="text-gray-600">Gana créditos completando cursos y participando en la comunidad.</p>
                    </div>
                    
                    <div class="grid md:grid-cols-3 gap-6">
                        <div class="stat-card bg-gradient-to-br from-yellow-50 to-yellow-100">
                            <div class="text-4xl mb-2">💰</div>
                            <div class="text-3xl font-bold text-yellow-600 mb-1">150</div>
                            <div class="text-yellow-600 font-semibold">Créditos Disponibles</div>
                        </div>
                        
                        <div class="stat-card bg-gradient-to-br from-green-50 to-green-100">
                            <div class="text-4xl mb-2">🎯</div>
                            <div class="text-3xl font-bold text-green-600 mb-1">250</div>
                            <div class="text-green-600 font-semibold">Créditos Ganados Totales</div>
                        </div>
                        
                        <div class="stat-card bg-gradient-to-br from-blue-50 to-blue-100">
                            <div class="text-4xl mb-2">🛒</div>
                            <div class="text-3xl font-bold text-blue-600 mb-1">100</div>
                            <div class="text-blue-600 font-semibold">Créditos Gastados</div>
                        </div>
                    </div>
                    
                    <div class="container-card p-8">
                        <h3 class="text-2xl font-semibold text-gray-800 mb-6">Historial de Créditos Ganados</h3>
                         <ul class="space-y-4">
                            <li class="flex justify-between items-center p-4 bg-gray-50 rounded-xl">
                                <div class="flex items-center gap-3">
                                     <span class="material-icons text-green-500">check_circle</span>
                                     <p class="font-semibold text-gray-700">Finalización del curso 'Historia de Honduras'</p>
                                </div>
                                <span class="font-bold text-green-600">+50 EduCréditos</span>
                            </li>
                             <li class="flex justify-between items-center p-4 bg-gray-50 rounded-xl">
                                <div class="flex items-center gap-3">
                                     <span class="material-icons text-green-500">check_circle</span>
                                     <p class="font-semibold text-gray-700">Completaste el Módulo 3 de 'Programación'</p>
                                </div>
                                <span class="font-bold text-green-600">+10 EduCréditos</span>
                            </li>
                         </ul>
                    </div>
                </div>
            `;
        }
        
        function renderNotificationsContent() {
             return `
                <div class="space-y-8 animate-fade-in">
                    <div>
                        <h2 class="text-3xl font-bold text-gray-800 mb-2">Notificaciones</h2>
                        <p class="text-gray-600">Aquí están tus últimas actualizaciones.</p>
                    </div>
                    <div class="space-y-4">
                        <div class="container-card p-4 flex items-center gap-4 hover:shadow-modern transition-shadow">
                            <div class="w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center"><span class="material-icons text-blue-600">info</span></div>
                            <div>
                                <p class="font-semibold text-gray-800">Tu progreso en 'Matemáticas Avanzadas' ha sido actualizado.</p>
                                <p class="text-sm text-gray-500">Hace 5 minutos</p>
                            </div>
                        </div>
                         <div class="container-card p-4 flex items-center gap-4 hover:shadow-modern transition-shadow">
                            <div class="w-12 h-12 bg-green-100 rounded-full flex items-center justify-center"><span class="material-icons text-green-600">check_circle</span></div>
                            <div>
                                <p class="font-semibold text-gray-800">¡Felicidades! Has completado el curso 'Historia de Honduras'.</p>
                                <p class="text-sm text-gray-500">Hace 2 horas</p>
                            </div>
                        </div>
                         <div class="container-card p-4 flex items-center gap-4 hover:shadow-modern transition-shadow">
                            <div class="w-12 h-12 bg-yellow-100 rounded-full flex items-center justify-center"><span class="material-icons text-yellow-600">announcement</span></div>
                            <div>
                                <p class="font-semibold text-gray-800">El nuevo círculo de 'Inglés Básico' está disponible para unirse.</p>
                                <p class="text-sm text-gray-500">Ayer</p>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }
        
        function renderPlansContent() {
             return `
                <div class="space-y-8 animate-fade-in">
                     <div>
                        <h2 class="text-3xl font-bold text-gray-800 mb-2">Planes y Suscripción</h2>
                        <p class="text-gray-600">Elige el plan que mejor se adapte a tus necesidades.</p>
                    </div>
                    <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-6 items-end">
                        <div class="container-card p-6 text-center flex flex-col h-full">
                           <div>
                             <h3 class="text-xl font-bold text-gray-800">Básico</h3>
                            <p class="text-4xl font-extrabold my-4">L. 0.00<span class="text-base font-normal">/mes</span></p>
                           </div>
                            <ul class="text-sm text-gray-600 space-y-3 mb-6 text-left flex-grow">
                                <li class="flex items-center gap-2"><span class="material-icons text-green-500">check</span>Acceso a Cursos Fundamentales</li>
                                <li class="flex items-center gap-2"><span class="material-icons text-green-500">check</span>Participación en Círculos</li>
                                <li class="flex items-center gap-2 text-gray-400"><span class="material-icons">close</span>Chat con IA (Limitado)</li>
                            </ul>
                            <button class="btn-secondary w-full py-3" disabled>Plan Actual</button>
                        </div>
                        <div class="container-card p-6 text-center shadow-modern-lg border-2 border-blue-500 relative flex flex-col h-full">
                             <div class="absolute -top-3 left-1/2 transform -translate-x-1/2 bg-blue-600 text-white px-3 py-1 rounded-full text-sm font-semibold">Popular</div>
                            <div>
                                <h3 class="text-xl font-bold text-blue-600">Pro</h3>
                                <p class="text-4xl font-extrabold my-4">L. 199<span class="text-base font-normal">/mes</span></p>
                            </div>
                            <ul class="text-sm text-gray-600 space-y-3 mb-6 text-left flex-grow">
                                <li class="flex items-center gap-2"><span class="material-icons text-green-500">check</span>Todo del Plan Básico</li>
                                <li class="flex items-center gap-2"><span class="material-icons text-green-500">check</span>Acceso Ilimitado a Cursos</li>
                                <li class="flex items-center gap-2"><span class="material-icons text-green-500">check</span>Chat con IA Completo</li>
                            </ul>
                            <button class="btn-primary w-full py-3">Seleccionar Pro</button>
                        </div>
                         <div class="container-card p-6 text-center flex flex-col h-full">
                            <div>
                                <h3 class="text-xl font-bold text-gray-800">Business</h3>
                                <p class="text-4xl font-extrabold my-4">L. 399<span class="text-base font-normal">/mes</span></p>
                            </div>
                            <ul class="text-sm text-gray-600 space-y-3 mb-6 text-left flex-grow">
                                <li class="flex items-center gap-2"><span class="material-icons text-green-500">check</span>Todo del Plan Pro</li>
                                <li class="flex items-center gap-2"><span class="material-icons text-green-500">check</span>Cuentas de Equipo</li>
                                <li class="flex items-center gap-2"><span class="material-icons text-green-500">check</span>Análisis Avanzado</li>
                            </ul>
                            <button class="btn-secondary w-full py-3">Seleccionar Business</button>
                        </div>
                        <div class="container-card p-6 text-center flex flex-col h-full">
                           <div>
                             <h3 class="text-xl font-bold text-gray-800">Personalizado</h3>
                            <p class="text-3xl font-extrabold my-4">¡Contáctanos!</p>
                           </div>
                             <ul class="text-sm text-gray-600 space-y-3 mb-6 text-left flex-grow">
                                <li class="flex items-center gap-2"><span class="material-icons text-green-500">check</span>Soluciones a la Medida</li>
                                <li class="flex items-center gap-2"><span class="material-icons text-green-500">check</span>Para Instituciones</li>
                                <li class="flex items-center gap-2"><span class="material-icons text-green-500">check</span>Soporte Prioritario</li>
                            </ul>
                            <button class="btn-secondary w-full py-3">Contactar</button>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderStudentProfileContent() {
            return `
                <div class="space-y-8 animate-fade-in">
                    <div>
                        <h2 class="text-3xl font-bold text-gray-800 mb-2">Mi Perfil de Estudiante</h2>
                        <p class="text-gray-600">Visualiza tu información y tus logros en la plataforma.</p>
                    </div>
                    <div class="container-card p-8 flex flex-col md:flex-row items-center gap-8">
                        <div class="w-32 h-32 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center font-bold text-white text-5xl shadow-modern-lg">
                            JP
                        </div>
                        <div class="text-center md:text-left">
                            <h3 class="text-2xl font-bold text-gray-800">Juan Pérez</h3>
                            <p class="text-gray-600">Estudiante de Bachillerato</p>
                            <div class="mt-4 flex gap-2 justify-center md:justify-start">
                                <span class="bg-blue-100 text-blue-700 font-semibold px-3 py-1 rounded-full text-sm">Matemáticas</span>
                                <span class="bg-green-100 text-green-700 font-semibold px-3 py-1 rounded-full text-sm">Historia</span>
                            </div>
                        </div>
                    </div>
                     <div class="container-card p-8">
                        <h3 class="text-2xl font-semibold text-gray-800 mb-6">Mis Certificados</h3>
                        <div class="space-y-4">
                            <div class="flex flex-col md:flex-row justify-between items-center p-4 bg-gray-50 rounded-xl">
                                <div class="flex items-center gap-4 mb-3 md:mb-0">
                                    <span class="material-icons text-yellow-500 text-3xl">workspace_premium</span>
                                    <div>
                                        <p class="font-semibold text-gray-700">Certificado de Finalización: Historia de Honduras</p>
                                        <p class="text-sm text-gray-500">Emitido el 01/08/2025</p>
                                    </div>
                                </div>
                                <button class="btn-secondary px-4 py-2 text-sm w-full md:w-auto">Descargar</button>
                            </div>
                            <div class="flex flex-col md:flex-row justify-between items-center p-4 bg-gray-50 rounded-xl">
                                <div class="flex items-center gap-4 mb-3 md:mb-0">
                                    <span class="material-icons text-yellow-500 text-3xl">workspace_premium</span>
                                     <div>
                                        <p class="font-semibold text-gray-700">Certificado de Finalización: Programación Básica</p>
                                        <p class="text-sm text-gray-500">Emitido el 15/07/2025</p>
                                    </div>
                                </div>
                                <button class="btn-secondary px-4 py-2 text-sm w-full md:w-auto">Descargar</button>
                            </div>
                        </div>
                    </div>
                     <div class="container-card p-8">
                        <h3 class="text-2xl font-semibold text-gray-800 mb-6">Mis Insignias</h3>
                        <div class="flex gap-6">
                             <div class="text-center">
                                <div class="w-20 h-20 bg-blue-100 rounded-full flex items-center justify-center mb-2"><span class="material-icons text-blue-500 text-4xl">military_tech</span></div>
                                <p class="font-semibold text-sm text-gray-700">Participante Activo</p>
                             </div>
                             <div class="text-center">
                                <div class="w-20 h-20 bg-green-100 rounded-full flex items-center justify-center mb-2"><span class="material-icons text-green-500 text-4xl">auto_stories</span></div>
                                <p class="font-semibold text-sm text-gray-700">Lector Voraz</p>
                             </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderStudentProgressContent() {
            return `
                 <div class="space-y-8 animate-fade-in">
                     <div>
                        <h2 class="text-3xl font-bold text-gray-800 mb-2">Mi Progreso Académico</h2>
                        <p class="text-gray-600">Sigue de cerca tu avance en todos tus cursos.</p>
                    </div>
                    <div class="container-card p-8">
                         <h3 class="text-2xl font-semibold text-gray-800 mb-6">Progreso en Cursos</h3>
                         <div class="space-y-6">
                            <div>
                                <p class="font-semibold text-gray-700 mb-2">Introducción a la Programación</p>
                                <div class="progress-container"><div class="progress-bar" style="width: 75%;"></div></div>
                                <p class="text-sm text-gray-500 mt-2">75% completado</p>
                            </div>
                             <div>
                                <p class="font-semibold text-gray-700 mb-2">Historia de Honduras</p>
                                <div class="progress-container"><div class="progress-bar" style="width: 20%;"></div></div>
                                <p class="text-sm text-gray-500 mt-2">20% completado</p>
                            </div>
                         </div>
                    </div>
                    <div class="container-card p-8">
                         <h3 class="text-2xl font-semibold text-gray-800 mb-6">Evaluaciones Recientes</h3>
                         <ul class="space-y-4">
                            <li class="flex justify-between items-center p-4 bg-gray-50 rounded-xl">
                                <p class="font-semibold text-gray-800">Cuestionario: Fundamentos de Lógica</p>
                                <span class="font-bold text-green-600">100%</span>
                            </li>
                             <li class="flex justify-between items-center p-4 bg-gray-50 rounded-xl">
                                <p class="font-semibold text-gray-800">Tarea: Análisis de la Conquista</p>
                                <span class="font-semibold text-yellow-600">Pendiente</span>
                            </li>
                         </ul>
                    </div>
                 </div>
            `;
        }

        function renderEducatorProfileContent() {
            return `
                 <div class="space-y-8 animate-fade-in">
                     <div>
                        <h2 class="text-3xl font-bold text-gray-800 mb-2">Perfil de Educador</h2>
                        <p class="text-gray-600">Mantén tu información profesional actualizada.</p>
                    </div>
                    <div class="container-card p-8">
                         <form class="space-y-6">
                            <div>
                                <label class="block text-gray-700 font-semibold mb-2">Nombre Completo</label>
                                <input type="text" value="Ana Meléndez" class="input-modern w-full">
                            </div>
                             <div>
                                <label class="block text-gray-700 font-semibold mb-2">Especialidad</label>
                                <input type="text" value="Matemáticas, Física" class="input-modern w-full">
                            </div>
                             <div>
                                <label class="block text-gray-700 font-semibold mb-2">Biografía</label>
                                <textarea rows="4" class="input-modern w-full resize-none">Soy una educadora apasionada por las ciencias exactas. Mi misión es hacer que el aprendizaje de las matemáticas sea divertido y accesible para todos.</textarea>
                            </div>
                            <button type="submit" class="btn-primary w-full py-3 rounded-xl">Guardar Cambios</button>
                         </form>
                    </div>
                </div>
            `;
        }

        // --- Resto de funciones de renderizado (Educator) ---
        function renderCourseManagementContent() {
            return `
                <div class="space-y-8 animate-fade-in">
                    <div>
                        <h2 class="text-3xl font-bold text-gray-800 mb-2">Gestión de Cursos</h2>
                        <p class="text-gray-600">Administra y crea tus cursos desde aquí.</p>
                    </div>
                    <button class="btn-primary px-6 py-3 rounded-xl flex items-center gap-2">
                        <span class="material-icons">add_circle</span>
                        Crear Nuevo Curso
                    </button>
                    <div class="container-card p-6">
                         <h3 class="text-xl font-semibold text-gray-800 mb-4">Mis Cursos Publicados</h3>
                         <div class="overflow-x-auto">
                            <table class="w-full text-left">
                                <thead class="border-b-2 border-gray-200">
                                    <tr>
                                        <th class="p-4 font-semibold text-gray-600">Curso</th>
                                        <th class="p-4 font-semibold text-gray-600">Estudiantes</th>
                                        <th class="p-4 font-semibold text-gray-600">Calificación</th>
                                        <th class="p-4 font-semibold text-gray-600">Acciones</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr class="border-b border-gray-100">
                                        <td class="p-4 font-medium text-gray-800">Cálculo Diferencial</td>
                                        <td class="p-4 text-gray-600">45</td>
                                        <td class="p-4 text-gray-600">4.8 ★</td>
                                        <td class="p-4 flex gap-2"><button class="btn-secondary px-3 py-1 text-sm">Editar</button><button class="text-red-500 p-1 rounded-md hover:bg-red-50">Eliminar</button></td>
                                    </tr>
                                    <tr class="border-b border-gray-100">
                                        <td class="p-4 font-medium text-gray-800">Física Básica</td>
                                        <td class="p-4 text-gray-600">75</td>
                                        <td class="p-4 text-gray-600">4.9 ★</td>
                                        <td class="p-4 flex gap-2"><button class="btn-secondary px-3 py-1 text-sm">Editar</button><button class="text-red-500 p-1 rounded-md hover:bg-red-50">Eliminar</button></td>
                                    </tr>
                                </tbody>
                            </table>
                         </div>
                    </div>
                </div>
            `;
        }
        function renderCircleCreationContent() {
            return `
                <div class="space-y-8 animate-fade-in">
                     <div>
                        <h2 class="text-3xl font-bold text-gray-800 mb-2">Crear un Nuevo Círculo</h2>
                        <p class="text-gray-600">Fomenta la colaboración creando una comunidad de estudio.</p>
                    </div>
                    <div class="container-card p-8">
                         <form class="space-y-6">
                            <div>
                                <label class="block text-gray-700 font-semibold mb-2">Nombre del Círculo</label>
                                <input type="text" placeholder="Ej: Círculo de Lectura de Literatura Hondureña" class="input-modern w-full">
                            </div>
                             <div>
                                <label class="block text-gray-700 font-semibold mb-2">Descripción</label>
                                <textarea rows="4" placeholder="Describe el propósito y las actividades del círculo..." class="input-modern w-full resize-none"></textarea>
                            </div>
                             <div>
                                <label class="block text-gray-700 font-semibold mb-2">Temas (separados por comas)</label>
                                <input type="text" placeholder="Ej: literatura, historia, arte" class="input-modern w-full">
                            </div>
                            <button type="submit" class="btn-primary w-full py-3 rounded-xl">Crear Círculo</button>
                         </form>
                    </div>
                </div>
            `;
        }
        function renderStudentManagementContent() {
            return `
                <div class="space-y-8 animate-fade-in">
                    <div>
                        <h2 class="text-3xl font-bold text-gray-800 mb-2">Gestión de Estudiantes</h2>
                        <p class="text-gray-600">Visualiza y gestiona los estudiantes inscritos en tus cursos.</p>
                    </div>
                    <div class="container-card p-6">
                        <div class="space-y-4">
                            <div class="flex justify-between items-center p-4 bg-gray-50 rounded-xl">
                                <div class="flex items-center gap-4">
                                    <div class="w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center font-bold text-blue-700">MR</div>
                                    <div>
                                        <p class="font-semibold text-gray-800">María Rodríguez</p>
                                        <p class="text-sm text-gray-500">Inscrita en: Cálculo Diferencial</p>
                                    </div>
                                </div>
                                <button class="btn-secondary px-4 py-2 text-sm">Ver Progreso</button>
                            </div>
                             <div class="flex justify-between items-center p-4 bg-gray-50 rounded-xl">
                                <div class="flex items-center gap-4">
                                    <div class="w-12 h-12 bg-green-100 rounded-full flex items-center justify-center font-bold text-green-700">CG</div>
                                    <div>
                                        <p class="font-semibold text-gray-800">Carlos Gómez</p>
                                        <p class="text-sm text-gray-500">Inscrito en: Física Básica</p>
                                    </div>
                                </div>
                                <button class="btn-secondary px-4 py-2 text-sm">Ver Progreso</button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }
        function renderAnalyticsContent() {
             return `
                <div class="space-y-8 animate-fade-in">
                     <div>
                        <h2 class="text-3xl font-bold text-gray-800 mb-2">Analíticas de Rendimiento</h2>
                        <p class="text-gray-600">Visualiza las métricas clave de tus cursos y estudiantes.</p>
                    </div>
                     <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-6">
                        <div class="stat-card"><div class="text-3xl font-bold text-blue-600">120</div><div class="text-gray-600">Estudiantes Totales</div></div>
                        <div class="stat-card"><div class="text-3xl font-bold text-green-600">L. 3,200</div><div class="text-gray-600">Ingresos Totales</div></div>
                        <div class="stat-card"><div class="text-3xl font-bold text-yellow-600">4.8 ★</div><div class="text-gray-600">Calificación Media</div></div>
                        <div class="stat-card"><div class="text-3xl font-bold text-purple-600">85%</div><div class="text-gray-600">Tasa de Finalización</div></div>
                    </div>
                     <div class="container-card p-8">
                        <h3 class="text-2xl font-semibold text-gray-800 mb-6">Rendimiento de Cursos</h3>
                        <div class="h-64 bg-gray-100 rounded-xl flex items-center justify-center text-gray-500">[Gráfica de rendimiento de cursos aquí]</div>
                    </div>
                </div>
            `;
        }
        function renderPaymentsContent() {
            return `
                 <div class="space-y-8 animate-fade-in">
                     <div>
                        <h2 class="text-3xl font-bold text-gray-800 mb-2">Pagos e Ingresos</h2>
                        <p class="text-gray-600">Gestiona tus ingresos y solicita tus pagos.</p>
                    </div>
                     <div class="grid md:grid-cols-2 gap-6">
                        <div class="container-card p-6 bg-gradient-to-br from-green-50 to-green-100">
                             <h3 class="text-xl font-semibold text-green-800 mb-2">Saldo Disponible</h3>
                             <p class="text-4xl font-bold text-green-700">L. 1,500.00</p>
                        </div>
                         <div class="container-card p-6 flex items-center justify-center">
                            <button class="btn-primary w-full py-4 text-lg">Solicitar Retiro</button>
                        </div>
                    </div>
                     <div class="container-card p-6">
                        <h3 class="text-xl font-semibold text-gray-800 mb-4">Historial de Transacciones</h3>
                        <table class="w-full text-left">
                           <thead class="border-b-2 border-gray-200">
                                <tr>
                                    <th class="p-4 font-semibold text-gray-600">Fecha</th>
                                    <th class="p-4 font-semibold text-gray-600">Descripción</th>
                                    <th class="p-4 font-semibold text-gray-600 text-right">Monto</th>
                                </tr>
                            </thead>
                             <tbody>
                                <tr class="border-b border-gray-100">
                                    <td class="p-4 text-gray-600">01/09/2025</td>
                                    <td class="p-4 font-medium text-gray-800">Pago por curso 'Cálculo'</td>
                                    <td class="p-4 text-green-600 font-semibold text-right">+ L. 250.00</td>
                                </tr>
                                 <tr class="border-b border-gray-100">
                                    <td class="p-4 text-gray-600">28/08/2025</td>
                                    <td class="p-4 font-medium text-gray-800">Retiro a cuenta bancaria</td>
                                    <td class="p-4 text-red-500 font-semibold text-right">- L. 2,000.00</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            `;
        }
        function renderEducatorCertificatesContent() {
            return `
                <div class="space-y-8 animate-fade-in">
                    <div>
                        <h2 class="text-3xl font-bold text-gray-800 mb-2">Gestión de Certificados</h2>
                        <p class="text-gray-600">Revisa los certificados emitidos para los estudiantes en tus cursos.</p>
                    </div>
                    <div class="container-card p-6">
                         <h3 class="text-xl font-semibold text-gray-800 mb-4">Certificados Emitidos Recientemente</h3>
                         <div class="overflow-x-auto">
                            <table class="w-full text-left">
                                <thead class="border-b-2 border-gray-200">
                                    <tr>
                                        <th class="p-4 font-semibold text-gray-600">Estudiante</th>
                                        <th class="p-4 font-semibold text-gray-600">Curso</th>
                                        <th class="p-4 font-semibold text-gray-600">Fecha de Emisión</th>
                                        <th class="p-4 font-semibold text-gray-600">Acciones</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr class="border-b border-gray-100">
                                        <td class="p-4 font-medium text-gray-800">María Rodríguez</td>
                                        <td class="p-4 text-gray-600">Cálculo Diferencial</td>
                                        <td class="p-4 text-gray-600">05/09/2025</td>
                                        <td class="p-4"><button class="btn-secondary px-3 py-1 text-sm">Ver Certificado</button></td>
                                    </tr>
                                    <tr class="border-b border-gray-100">
                                        <td class="p-4 font-medium text-gray-800">Carlos Gómez</td>
                                        <td class="p-4 text-gray-600">Física Básica</td>
                                        <td class="p-4 text-gray-600">02/09/2025</td>
                                        <td class="p-4"><button class="btn-secondary px-3 py-1 text-sm">Ver Certificado</button></td>
                                    </tr>
                                     <tr class="border-b border-gray-100">
                                        <td class="p-4 font-medium text-gray-800">Juan Pérez</td>
                                        <td class="p-4 text-gray-600">Historia de Honduras</td>
                                        <td class="p-4 text-gray-600">01/08/2025</td>
                                        <td class="p-4"><button class="btn-secondary px-3 py-1 text-sm">Ver Certificado</button></td>
                                    </tr>
                                </tbody>
                            </table>
                         </div>
                    </div>
                </div>
            `;
        }
        function renderViewCourseContent(courseId) {
            const courseData = {
                'programacion': {
                    title: 'Introducción a la Programación',
                    description: 'Este curso es perfecto para principiantes. Aprenderás los fundamentos de la lógica de programación, algoritmos y estructuras de datos básicas. Al completar este curso, habrás ganado una base sólida para iniciar tu camino en el mundo del desarrollo de software.',
                    videoUrl: 'https://www.youtube.com/embed/mIVbUb7shE8?si=H-U7XBFCDXx3vtEn',
                    modules: [
                        { title: 'Módulo 1: ¿Qué es un Algoritmo?', completed: true },
                        { title: 'Módulo 2: Variables y Tipos de Datos', completed: true },
                        { title: 'Módulo 3: Estructuras de Control', completed: false },
                        { title: 'Módulo 4: Funciones y Procedimientos', completed: false }
                    ],
                    resources: ['Guía de conceptos básicos (PDF)', 'Plataforma de práctica online']
                },
                'historia': {
                    title: 'Historia de Honduras',
                    description: 'Un viaje a través del pasado de nuestra nación. Desde la era precolombina hasta la actualidad, este curso explora los eventos, las figuras y los movimientos que han moldeado a Honduras. Ideal para estudiantes de bachillerato y cualquier persona interesada en nuestra cultura.',
                    videoUrl: 'https://www.youtube.com/embed/SBojX_6hZko?si=_bQN-t9nbGrJJl0q',
                    modules: [
                        { title: 'Módulo 1: La Época Precolombina', completed: true },
                        { title: 'Módulo 2: La Conquista Española', completed: false },
                        { title: 'Módulo 3: La Independencia', completed: false },
                        { title: 'Módulo 4: Siglo XX y Actualidad', completed: false }
                    ],
                    resources: ['Cronología histórica (PDF)', 'Documental "Honduras a través del tiempo"']
                }
            };

            const course = courseData[courseId];
            if (!course) {
                return `<div class="text-center py-20">Curso no encontrado.</div>`;
            }

            const modulesHTML = course.modules.map(mod => `
                <li class="flex items-center justify-between p-4 rounded-xl ${mod.completed ? 'bg-green-50' : 'bg-gray-100'}">
                    <div class="flex items-center gap-3">
                        <span class="material-icons ${mod.completed ? 'text-green-600' : 'text-gray-500'}">play_circle_filled</span>
                        <span class="font-medium ${mod.completed ? 'text-gray-800' : 'text-gray-600'}">${mod.title}</span>
                    </div>
                    <span class="material-icons ${mod.completed ? 'text-green-600' : 'text-gray-400'}">${mod.completed ? 'check_circle' : 'radio_button_unchecked'}</span>
                </li>
            `).join('');
            
            const resourcesHTML = course.resources.map(res => `
                <li class="flex items-center gap-2 text-blue-600 hover:underline cursor-pointer">
                    <span class="material-icons">attach_file</span>
                    <span>${res}</span>
                </li>
            `).join('');

            return `
                <div class="animate-fade-in">
                    <button onclick="showDashboardContent('courses')" class="btn-secondary mb-6 flex items-center gap-2">
                        <span class="material-icons">arrow_back</span>
                        Volver a Cursos
                    </button>
                    <h2 class="text-3xl font-bold text-gray-800 mb-2">${course.title}</h2>
                    <p class="text-gray-600 mb-6">${course.description}</p>

                    <div class="grid lg:grid-cols-3 gap-8">
                        <div class="lg:col-span-2">
                            <div class="aspect-w-16 aspect-h-9 mb-8">
                                <iframe class="w-full h-96 rounded-2xl shadow-modern-lg" src="${course.videoUrl}" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                            </div>
                            <div class="container-card p-6">
                                <h3 class="text-xl font-semibold text-gray-800 mb-4">Recursos Adicionales</h3>
                                <ul class="space-y-3">${resourcesHTML}</ul>
                            </div>
                        </div>
                        <div class="lg:col-span-1">
                             <div class="container-card p-6">
                                <h3 class="text-xl font-semibold text-gray-800 mb-4">Lecciones del Curso</h3>
                                <ul class="space-y-3">${modulesHTML}</ul>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }
        function renderViewCircleContent(circleId) {
            return `
                <div class="h-full flex flex-col animate-fade-in">
                    <div class="mb-6">
                        <h2 class="text-3xl font-bold text-gray-800 mb-2">Círculo de ${circleId}</h2>
                        <p class="text-gray-600">Un espacio para debatir y aprender en comunidad.</p>
                    </div>
                    
                    <div class="flex-1 bg-gray-50 rounded-2xl p-6 flex flex-col">
                        <div id="circle-messages" class="flex-1 overflow-y-auto space-y-4 mb-6 pr-2">
                            <div class="flex justify-start">
                                <div class="chat-message-ai">
                                    ¡Bienvenidos al círculo de ${circleId}! Siéntanse libres de iniciar una discusión.
                                </div>
                            </div>
                             <div class="flex justify-end">
                                <div class="chat-message-user">
                                    ¡Hola a todos! ¿Alguien tiene alguna pregunta sobre el último capítulo?
                                </div>
                            </div>
                        </div>
                        
                        <div class="flex gap-3">
                            <input type="text" id="circle-input" 
                                   placeholder="Escribe tu mensaje..." 
                                   class="flex-1 input-modern">
                            <button id="circle-send-button" class="btn-primary px-6 py-3 rounded-xl flex items-center gap-2">
                                <span class="material-icons">send</span>
                            </button>
                        </div>
                    </div>
                </div>
            `;
        }

        // --- Chat functionality ---
        async function callGeminiAPI(prompt) {
            // This now calls the serverless function
            const apiUrl = '/api/chat'; 
            
            const requestBody = {
                prompt: prompt
            };

            try {
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(requestBody)
                });

                if (!response.ok) {
                    const errorData = await response.json();
                    return errorData.error || "Lo siento, estoy teniendo problemas para conectarme. Inténtalo de nuevo más tarde.";
                }
                const result = await response.json();
                return result.response;
            } catch (error) {
                console.error("Error calling serverless function:", error);
                return "Ocurrió un error al contactar al asistente de IA.";
            }
        }
        
        function initializeChat() {
            const chatInput = document.getElementById('chat-input');
            const sendButton = document.getElementById('send-button');
            const chatMessages = document.getElementById('chat-messages');
            const loadingIndicator = document.getElementById('loading-indicator');

            async function sendMessage() {
                const message = chatInput.value.trim();
                if (!message) return;

                const userMessageDiv = document.createElement('div');
                userMessageDiv.className = 'flex justify-end';
                userMessageDiv.innerHTML = `<div class="chat-message-user">${message}</div>`;
                chatMessages.appendChild(userMessageDiv);

                chatInput.value = '';
                loadingIndicator.classList.remove('hidden');
                chatMessages.scrollTop = chatMessages.scrollHeight;

                try {
                    const response = await callGeminiAPI(message);
                    loadingIndicator.classList.add('hidden');
                    const aiMessageDiv = document.createElement('div');
                    aiMessageDiv.className = 'flex justify-start';
                    aiMessageDiv.innerHTML = `<div class="chat-message-ai">${response.replace(/\n/g, '<br>')}</div>`;
                    chatMessages.appendChild(aiMessageDiv);
                    chatMessages.scrollTop = chatMessages.scrollHeight;
                } catch (error) {
                    loadingIndicator.classList.add('hidden');
                    const errorDiv = document.createElement('div');
                    errorDiv.className = 'flex justify-start';
                    errorDiv.innerHTML = `<div class="chat-message-ai">Lo siento, hubo un error. Inténtalo de nuevo.</div>`;
                    chatMessages.appendChild(errorDiv);
                }
            }

            sendButton.addEventListener('click', sendMessage);
            chatInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    sendMessage();
                }
            });
        }
        
        function initializeCircleChat() {
            const circleInput = document.getElementById('circle-input');
            const sendButton = document.getElementById('circle-send-button');
            const circleMessages = document.getElementById('circle-messages');

            function postMessage() {
                 const message = circleInput.value.trim();
                if (!message) return;

                const messageDiv = document.createElement('div');
                messageDiv.className = 'flex justify-end';
                messageDiv.innerHTML = `<div class="chat-message-user">${message}</div>`;
                circleMessages.appendChild(messageDiv);
                circleInput.value = '';
                circleMessages.scrollTop = circleMessages.scrollHeight;
            }

            sendButton.addEventListener('click', postMessage);
             circleInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    postMessage();
                }
            });
        }

        // Navigation link styles
        const navLinkStyle = `
            .nav-link {
                position: relative;
                padding: 8px 16px;
                border-radius: 8px;
                transition: all 0.3s ease;
                color: #6b7280;
                font-weight: 500;
                text-decoration: none;
                border: none;
                background: none;
                cursor: pointer;
            }
            
            .nav-link:hover {
                color: #3b82f6;
            }
            
            .nav-link.active {
                color: #3b82f6;
                background: rgba(59, 130, 246, 0.1);
            }
            
            .nav-link.active::after {
                content: '';
                position: absolute;
                bottom: -4px;
                left: 50%;
                transform: translateX(-50%);
                width: 80%;
                height: 2px;
                background: #3b82f6;
                border-radius: 2px;
            }
        `;

        // Add the styles to the document
        const styleSheet = document.createElement('style');
        styleSheet.textContent = navLinkStyle;
        document.head.appendChild(styleSheet);

        // Initialize the application
        window.addEventListener('DOMContentLoaded', () => {
            showPage('landing-page');
        });

        // Handle window resize for tutorial positioning
        window.addEventListener('resize', () => {
            if (!document.getElementById('welcome-tutorial').classList.contains('hidden')) {
                setTimeout(renderTutorialStep, 100);
            }
        });
    </script>
</body>
</html>

